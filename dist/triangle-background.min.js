function Triangle(){this.colour=this.getRandomColour(),this.nodes=[],this.center={x:0,y:0},this.hasHighlight=!1}function TriangleNode(t,e,i){this.x=t,this.y=e,this.direction=i}function TriangleNodeManager(t,e,i,n){this.spacing=e,this.nodes=[new TriangleNode(t.x,t.y,0)],this.queue=[0],this.triangles=[],this.ctx=i,this.bounds=n,this.calculatePositions(),this.drawableTriangles=this.triangles,this.drawTriangles(),this.drawableTriangles=[]}function TriangleBackground(t,e){switch(typeof t){case"string":this.containerElement=document.querySelector(t);break;case"object":this.containerElement=t;break;default:return void console.log("TriangleBackground: First argument should be a CSS selector or a DOM element")}e&&(e.color&&(Triangle.prototype.availableColours=e.color),e.mouseHoverHighlight&&e.mouseHoverHighlight.color&&(Triangle.prototype.highlightColour=e.mouseHoverHighlight.color)),this.triangleSize=50,this.initFrame(),this.initTriangles(),window.addEventListener("resize",this.resize.bind(this)),e&&e.mouseHoverHighlight===!1||this.containerElement.addEventListener("mousemove",this.mouseMove.bind(this))}Triangle.prototype.availableColours=["#dddddd","#cccccc","#bbbbbb","#aaaaaa"],Triangle.prototype.highlightColour="#ffffff",Triangle.prototype.getRandomColour=function(){function t(t,e){return Math.round(Math.random()*(e-t))+t}return this.availableColours[t(0,this.availableColours.length-1)]},Triangle.prototype.draw=function(t,e){t.fillStyle=this.getColour(e),t.beginPath(),this.nodes.map(function(e){t.lineTo(e.x,e.y)}.bind(this)),t.fill(),t.closePath()},Triangle.prototype.getColour=function(t){var e=0;return"undefined"!=typeof t.x&&"undefined"!=typeof t.y&&(e=this.getMouseDistance(this.center,t),e=e>100?100:e,e=100-e),this.hasHighlight=e>0,this.changeColour(this.colour,this.highlightColour,e)},Triangle.prototype.getMouseDistance=function(t,e){return Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2))},Triangle.prototype.changeColour=function(t,e,i){var n=this.hexToRGB(t),r=this.hexToRGB(e),o={r:(r.r-n.r)*(i/100),g:(r.g-n.g)*(i/100),b:(r.b-n.b)*(i/100)};return this.RGBToHex({r:Math.round(n.r+o.r),g:Math.round(n.g+o.g),b:Math.round(n.b+o.b)})},Triangle.prototype.hexToRGB=function(t){var e=parseInt(t.substr(1,2),16),i=parseInt(t.substr(3,2),16),n=parseInt(t.substr(5,2),16);return{r:e,g:i,b:n}},Triangle.prototype.RGBToHex=function(t){function e(t){var e=t.toString(16);return 1===e.length?"0"+e:e}return"#"+e(t.r)+e(t.g)+e(t.b)},Triangle.prototype.calculateCenter=function(){var t=0,e=0,i=0,n=0;this.nodes&&(this.nodes.map(function(r){t=t?Math.max(t,r.x):r.x,i=i?Math.max(i,r.y):r.y,e=e?Math.min(e,r.x):r.x,n=n?Math.min(n,r.y):r.y}),this.center.x=e+(t-e)/2,this.center.y=n+(i-n)/2)},TriangleNode.prototype.extrapolateTriangles=function(t){for(var e=[],i=0;6>i;i++){var n=new Triangle;n.nodes.push(this),n.nodes.push(new TriangleNode(this.x+Math.cos(this.direction)*t,this.y+Math.sin(this.direction)*t,this.direction)),this.rotate(),n.nodes.push(new TriangleNode(this.x+Math.cos(this.direction)*t,this.y+Math.sin(this.direction)*t,this.direction)),n.calculateCenter(),e.push(n)}return e},TriangleNode.prototype.rotate=function(){var t=60,e=t*(Math.PI/180);this.direction+=e,this.direction>360*(Math.PI/180)&&(this.direction-=360*(Math.PI/180))},TriangleNodeManager.prototype.restart=function(t){this.nodes=[new TriangleNode(t.x,t.y,0)],this.queue=[0],this.triangles=[],this.calculatePositions(),this.drawableTriangles=this.triangles},TriangleNodeManager.prototype.calculatePositions=function(){for(;this.queue.length>0;){var t=this.nodes[this.queue.shift()],e=t.extrapolateTriangles(this.spacing);e.map(function(t){var e=t.nodes[1];this.findNode(e)||this.isOutOfBounds(e)||(this.nodes.push(e),this.queue.push(this.nodes.indexOf(e)))}.bind(this)),e=e.filter(function(t){return!this.findTriangle(t)}.bind(this)),this.triangles=this.triangles.concat(e)}},TriangleNodeManager.prototype.drawTriangles=function(){this.drawableTriangles.map(function(t){t.draw(this.ctx,{x:this.mouseX,y:this.mouseY})}.bind(this)),window.requestAnimationFrame(this.drawTriangles.bind(this))},TriangleNodeManager.prototype.findNode=function(t){var e=this.nodes.filter(function(e){return Math.round(e.x)===Math.round(t.x)&&Math.round(e.y)===Math.round(t.y)});return e.length},TriangleNodeManager.prototype.isOutOfBounds=function(t){return t.x>this.bounds.width||t.x<0||t.y>this.bounds.height||t.y<0?!0:!1},TriangleNodeManager.prototype.findTriangle=function(t){var e=this.triangles.filter(function(e){return Math.round(e.center.x)===Math.round(t.center.x)&&Math.round(e.center.y)===Math.round(t.center.y)});return e.length},TriangleNodeManager.prototype.setMousePosition=function(t,e){this.mouseX=t,this.mouseY=e,this.drawableTriangles=this.getDrawableTriangles()},TriangleNodeManager.prototype.getDrawableTriangles=function(){return this.triangles.filter(function(t){var e=Math.abs(t.center.x-this.mouseX)<150&&Math.abs(t.center.y-this.mouseY)<150,i=!e&&t.hasHighlight;return e||i}.bind(this))},TriangleBackground.prototype.initFrame=function(){this.canvasElement=document.createElement("canvas"),this.drawingContext=this.canvasElement.getContext("2d"),this.containerElement.appendChild(this.canvasElement),this.containerElement.style.position="fixed",this.containerElement.style.width="100%",this.containerElement.style.height="100%",this.calculateSize()},TriangleBackground.prototype.calculateSize=function(){this.width=this.containerElement.clientWidth,this.height=this.containerElement.clientHeight,this.canvasElement.width=this.width,this.canvasElement.height=this.height},TriangleBackground.prototype.resize=function(){this.calculateSize(),this.restartTriangles()},TriangleBackground.prototype.mouseMove=function(t){this.nodeManager&&this.nodeManager.setMousePosition(t.offsetX,t.offsetY)},TriangleBackground.prototype.initTriangles=function(){var t={x:this.width/2,y:this.height/2};this.nodeManager=new TriangleNodeManager(t,this.triangleSize,this.drawingContext,{width:this.width,height:this.height})},TriangleBackground.prototype.restartTriangles=function(){var t={x:this.width/2,y:this.height/2};this.nodeManager.restart(t)},"object"==typeof module&&"object"==typeof module.exports&&(module.exports=TriangleBackground);